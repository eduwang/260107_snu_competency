<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì›Œí¬ìˆ í™œë™ - ë©”ì¸</title>
  <link rel="stylesheet" href="src/common.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="node_modules/sweetalert2/dist/sweetalert2.min.css">
  <style>
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .user-section {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .user-info {
      color: white;
      font-weight: 500;
    }
    
    .login-btn, .logout-btn {
      padding: 0.625rem 1.25rem;
      background: white;
      color: var(--primary-color);
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9375rem;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .login-btn:hover, .logout-btn:hover {
      background: #f3f4f6;
      transform: translateY(-1px);
    }
    
    .nav-item {
      display: none;
      transition: opacity 0.3s;
    }
    
    .nav-item.visible {
      display: flex;
      opacity: 1;
      pointer-events: auto;
    }
    
    .nav-item.admin-only {
      display: none;
    }
    
    .nav-item.admin-only.show {
      display: flex;
    }
    
    .login-message {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 400px;
      text-align: center;
      padding: 3rem 2rem;
    }
    
    .login-message.hidden {
      display: none;
    }
    
    .login-message-icon {
      font-size: 4rem;
      margin-bottom: 1.5rem;
      opacity: 0.6;
    }
    
    .login-message h2 {
      font-size: 1.75rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 1rem;
    }
    
    .login-message p {
      font-size: 1.125rem;
      color: var(--text-secondary);
      margin: 0;
    }
    
    .nav-menu.hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-content">
        <div class="header-text">
          <h1>SNU ì—­ëŸ‰í‰ê°€ ë©´ì ‘ ì„ ë„êµì‚¬ ì›Œí¬ìˆ</h1>
          <p class="subtitle">SNU ì—­ëŸ‰í‰ê°€ ë©´ì ‘ ì„ ë„êµì‚¬ ì›Œí¬ìˆ</p>
        </div>
        <div class="user-section">
          <span id="userInfo" class="user-info">ğŸ” ë¡œê·¸ì¸ í›„ ì´ìš©í•´ ì£¼ì„¸ìš”.</span>
          <button id="loginBtn" class="login-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
              <polyline points="10 17 15 12 10 7"></polyline>
              <line x1="15" y1="12" x2="3" y2="12"></line>
            </svg>
            Google ë¡œê·¸ì¸
          </button>
          <button id="logoutBtn" class="logout-btn" style="display: none;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            ë¡œê·¸ì•„ì›ƒ
          </button>
        </div>
      </div>
    </header>

    <main>
      <div id="loginMessage" class="login-message">
        <div class="login-message-icon">ğŸ”</div>
        <h2>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h2>
        <p>ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ì‹œë ¤ë©´ ë¨¼ì € ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.</p>
      </div>
      
      <nav class="nav-menu hidden">
        <a href="activity01.html" class="nav-item" id="nav-activity01">
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="16" y1="13" x2="8" y2="13"></line>
            <line x1="16" y1="17" x2="8" y2="17"></line>
            <polyline points="10 9 9 9 8 9"></polyline>
          </svg>
          <h2>í™œë™ 1</h2>
          <p>ì²« ë²ˆì§¸ í™œë™ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
        </a>

        <a href="makeProbingQuestions.html" class="nav-item" id="nav-probing">
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            <line x1="9" y1="10" x2="15" y2="10"></line>
            <line x1="9" y1="14" x2="15" y2="14"></line>
          </svg>
          <h2>íƒì¹¨ì§ˆë¬¸ ë§Œë“¤ê¸°</h2>
          <p>ë©´ì ‘ê´€ê³¼ ê°€ìƒì˜ í•™ìƒ ì‚¬ì´ì˜ ëŒ€í™”ë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ê³  íƒì¹¨ì§ˆë¬¸ì„ ì œì‘í•©ë‹ˆë‹¤.</p>
        </a>

        <a href="results.html" class="nav-item" id="nav-results">
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="8" y1="6" x2="21" y2="6"></line>
            <line x1="8" y1="12" x2="21" y2="12"></line>
            <line x1="8" y1="18" x2="21" y2="18"></line>
            <line x1="3" y1="6" x2="3.01" y2="6"></line>
            <line x1="3" y1="12" x2="3.01" y2="12"></line>
            <line x1="3" y1="18" x2="3.01" y2="18"></line>
          </svg>
          <h2>ë‹¤ë¥¸ ì‚¬ëŒ ê²°ê³¼ ë³´ê¸°</h2>
          <p>ë‹¤ë¥¸ ì°¸ê°€ìë“¤ì´ ì œì‘í•œ íƒì¹¨ì§ˆë¬¸ê³¼ ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
        </a>

        <a href="admin.html" class="nav-item admin-only" id="nav-admin">
          <svg class="card-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
          <h2>ê´€ë¦¬ì í˜ì´ì§€</h2>
          <p>ëª¨ë“  ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ì‚¬ìš©ìë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.</p>
        </a>
      </nav>
    </main>

    <footer class="footer">
      <p>&copy; 2026 SNU ì—­ëŸ‰í‰ê°€ ë©´ì ‘ ì„ ë„êµì‚¬ ì›Œí¬ìˆ</p>
    </footer>
  </div>

  <script type="module">
    import { auth, googleProvider, isAdmin, db } from './src/firebaseConfig.js';
    import { signInWithPopup, signOut, onAuthStateChanged } from 'firebase/auth';
    import { collection, getDocs, query, where, doc, getDoc, updateDoc, serverTimestamp } from 'firebase/firestore';
    import Swal from 'sweetalert2';

    // DOM ìš”ì†Œ
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const userInfo = document.getElementById('userInfo');
    const loginMessage = document.getElementById('loginMessage');
    const navMenu = document.querySelector('.nav-menu');
    const navItems = {
      activity01: document.getElementById('nav-activity01'),
      probing: document.getElementById('nav-probing'),
      results: document.getElementById('nav-results'),
      admin: document.getElementById('nav-admin')
    };

    // ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    loginBtn.addEventListener('click', async () => {
      console.log('ğŸ” ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ë¨');
      
      // ë¡œë”© ì•Œë¦¼ í‘œì‹œ
      Swal.fire({
        title: 'ë¡œê·¸ì¸ ì¤‘...',
        text: 'Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.',
        allowOutsideClick: false,
        allowEscapeKey: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      try {
        console.log('ğŸ” Google ë¡œê·¸ì¸ íŒì—… ì—´ê¸° ì‹œë„...');
        const result = await signInWithPopup(auth, googleProvider);
        console.log('âœ… ë¡œê·¸ì¸ ì„±ê³µ:', result.user.email);
        
        // ë¡œë”© ì•Œë¦¼ ë‹«ê¸° (ì„±ê³µì€ onAuthStateChangedì—ì„œ ì²˜ë¦¬)
        Swal.close();
        
      } catch (error) {
        console.error('âŒ ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
        console.error('ì—ëŸ¬ ì½”ë“œ:', error.code);
        console.error('ì—ëŸ¬ ë©”ì‹œì§€:', error.message);
        
        let errorMessage = 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
        let errorTitle = 'ë¡œê·¸ì¸ ì‹¤íŒ¨';
        
        if (error.code === 'auth/popup-closed-by-user') {
          errorMessage = 'ë¡œê·¸ì¸ ì°½ì´ ë‹«í˜”ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
          errorTitle = 'ë¡œê·¸ì¸ ì·¨ì†Œ';
        } else if (error.code === 'auth/cancelled-popup-request') {
          errorMessage = 'ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.';
        } else if (error.code === 'auth/popup-blocked') {
          errorMessage = 'íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.';
        } else if (error.code === 'auth/unauthorized-domain') {
          errorMessage = 'ì¸ì¦ë˜ì§€ ì•Šì€ ë„ë©”ì¸ì…ë‹ˆë‹¤. Firebase Consoleì—ì„œ ë„ë©”ì¸ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.';
        } else if (error.message) {
          errorMessage = error.message;
        }
        
        Swal.fire({
          icon: 'error',
          title: errorTitle,
          text: errorMessage,
          confirmButtonText: 'í™•ì¸'
        });
      }
    });

    // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
    logoutBtn.addEventListener('click', async () => {
      const result = await Swal.fire({
        title: 'ë¡œê·¸ì•„ì›ƒ',
        text: 'ì •ë§ ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
        icon: 'question',
        showCancelButton: true,
        confirmButtonText: 'ë¡œê·¸ì•„ì›ƒ',
        cancelButtonText: 'ì·¨ì†Œ',
        confirmButtonColor: '#ef4444'
      });

      if (result.isConfirmed) {
        try {
          await signOut(auth);
          Swal.fire({
            icon: 'success',
            title: 'ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ',
            text: 'ì„±ê³µì ìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤.',
            timer: 1500,
            showConfirmButton: false
          });
        } catch (error) {
          console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
          Swal.fire({
            icon: 'error',
            title: 'ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨',
            text: 'ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
            confirmButtonText: 'í™•ì¸'
          });
        }
      }
    });

    // ë„¤ë¹„ê²Œì´ì…˜ í•­ëª© í´ë¦­ ì´ë²¤íŠ¸ (ë¡œê·¸ì¸ ì²´í¬)
    Object.values(navItems).forEach(navItem => {
      if (navItem && navItem !== navItems.admin) {
        navItem.addEventListener('click', (e) => {
          if (!auth.currentUser) {
            e.preventDefault();
            Swal.fire({
              icon: 'warning',
              title: 'ë¡œê·¸ì¸ í•„ìš”',
              text: 'ì´ í˜ì´ì§€ë¥¼ ì´ìš©í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.',
              confirmButtonText: 'í™•ì¸'
            });
          }
        });
      }
    });

    // ë©”ë‰´ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ë° ì ìš©
    async function loadMenuSettings() {
      try {
        const settingsDoc = await getDoc(doc(db, 'menuSettings', 'main'));
        
        if (settingsDoc.exists()) {
          const data = settingsDoc.data();
          
          // í™œë™ 1 í‘œì‹œ/ìˆ¨ê¹€
          if (data.activity1 === false) {
            navItems.activity01.style.display = 'none';
          } else {
            navItems.activity01.style.display = 'flex';
          }
          
          // í™œë™ 2 í‘œì‹œ/ìˆ¨ê¹€ (íƒì¹¨ì§ˆë¬¸ ë§Œë“¤ê¸°, ë‹¤ë¥¸ ì‚¬ëŒ ê²°ê³¼ë³´ê¸°)
          if (data.activity2 === false) {
            navItems.probing.style.display = 'none';
            navItems.results.style.display = 'none';
          } else {
            navItems.probing.style.display = 'flex';
            navItems.results.style.display = 'flex';
          }
        }
      } catch (error) {
        console.error('ë©”ë‰´ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', error);
      }
    }

    // ì‚¬ìš©ì ì½”ë“œ í™•ì¸ ë° ì—°ê²°
    async function checkAndLinkUserCode(user) {
      try {
        // ì´ë¯¸ ì—°ê²°ëœ ì‚¬ìš©ìì¸ì§€ í™•ì¸
        const userQuery = query(collection(db, 'users'), where('uid', '==', user.uid));
        const userSnapshot = await getDocs(userQuery);
        
        if (!userSnapshot.empty) {
          // ì´ë¯¸ ì—°ê²°ëœ ì‚¬ìš©ì
          return;
        }

        // ì½”ë“œ ì…ë ¥ë°›ê¸°
        const result = await Swal.fire({
          title: 'ì‚¬ìš©ì ì½”ë“œ ì…ë ¥',
          text: 'ê´€ë¦¬ìê°€ ë°œê¸‰í•œ 5ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
          input: 'text',
          inputPlaceholder: 'ì½”ë“œ ì…ë ¥',
          inputAttributes: {
            maxlength: 5,
            style: 'text-transform: uppercase; font-family: monospace; font-size: 1.5rem; text-align: center; letter-spacing: 0.5rem;'
          },
          showCancelButton: false,
          confirmButtonText: 'í™•ì¸',
          allowOutsideClick: false,
          allowEscapeKey: false,
          inputValidator: (value) => {
            if (!value || value.length !== 5) {
              return '5ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
            }
            return null;
          }
        });

        if (result.isConfirmed && result.value) {
          const code = result.value.toUpperCase().trim();
          
          // ê´€ë¦¬ì ì½”ë“œ í™•ì¸ (12345)
          if (code === '12345') {
            Swal.fire({
              icon: 'success',
              title: 'ê´€ë¦¬ì ì¸ì¦',
              text: 'ê´€ë¦¬ìë¡œ ë¡œê·¸ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.',
              timer: 2000,
              showConfirmButton: false
            });
            return; // ê´€ë¦¬ìëŠ” ë°”ë¡œ í†µê³¼
          }
          
          // ì½”ë“œë¡œ ì‚¬ìš©ì ì°¾ê¸°
          const codeQuery = query(collection(db, 'users'), where('code', '==', code));
          const codeSnapshot = await getDocs(codeQuery);
          
          if (codeSnapshot.empty) {
            Swal.fire({
              icon: 'error',
              title: 'ì½”ë“œ ì˜¤ë¥˜',
              text: 'ì…ë ¥í•œ ì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
              confirmButtonText: 'í™•ì¸'
            });
            // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
            await signOut(auth);
            return;
          }

          const userDoc = codeSnapshot.docs[0];
          const userData = userDoc.data();
          
          if (userData.uid) {
            Swal.fire({
              icon: 'error',
              title: 'ì½”ë“œ ì‚¬ìš©ë¨',
              text: 'ì´ë¯¸ ì‚¬ìš©ëœ ì½”ë“œì…ë‹ˆë‹¤.',
              confirmButtonText: 'í™•ì¸'
            });
            // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
            await signOut(auth);
            return;
          }

          // ì‚¬ìš©ì ì—°ê²°
          await updateDoc(doc(db, 'users', userDoc.id), {
            uid: user.uid,
            linkedAt: serverTimestamp()
          });

          Swal.fire({
            icon: 'success',
            title: 'ì—°ê²° ì™„ë£Œ',
            text: 'ì‚¬ìš©ì ê³„ì •ì´ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤!',
            timer: 2000,
            showConfirmButton: false
          });
        } else {
          // ì½”ë“œ ì…ë ¥ ì·¨ì†Œ ì‹œ ë¡œê·¸ì•„ì›ƒ
          await signOut(auth);
        }
        
      } catch (error) {
        console.error('ì‚¬ìš©ì ì½”ë“œ í™•ì¸ ì˜¤ë¥˜:', error);
        Swal.fire({
          icon: 'error',
          title: 'ì˜¤ë¥˜',
          text: 'ì‚¬ìš©ì ì½”ë“œ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
          confirmButtonText: 'í™•ì¸'
        });
        await signOut(auth);
      }
    }

    // ì¸ì¦ ìƒíƒœ ë³€ê²½ ê°ì§€
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        // ë¡œê·¸ì¸ëœ ê²½ìš°
        userInfo.textContent = `ğŸ‘¤ ${user.displayName || user.email} ë‹˜`;
        loginBtn.style.display = 'none';
        logoutBtn.style.display = 'flex';

        // ë¡œê·¸ì¸ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°, ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ í‘œì‹œ
        loginMessage.classList.add('hidden');
        navMenu.classList.remove('hidden');

        // ê´€ë¦¬ìê°€ ì•„ë‹Œ ê²½ìš° ì‚¬ìš©ì ì½”ë“œ í™•ì¸
        if (!isAdmin(user.uid)) {
          await checkAndLinkUserCode(user);
        }

        // ë©”ë‰´ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
        await loadMenuSettings();

        // ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ í•­ëª© í™œì„±í™”
        Object.values(navItems).forEach(navItem => {
          if (navItem && navItem.style.display !== 'none') {
            navItem.classList.add('visible');
          }
        });

        // ê´€ë¦¬ì ì—¬ë¶€ í™•ì¸
        const userIsAdmin = isAdmin(user.uid);
        if (userIsAdmin) {
          navItems.admin.classList.add('show');
        } else {
          navItems.admin.classList.remove('show');
        }

        // ë¡œê·¸ì¸ ì„±ê³µ ì•Œë¦¼ (ì²˜ìŒ ë¡œê·¸ì¸í•œ ê²½ìš°ì—ë§Œ, ë¡œë”©ì´ ì´ë¯¸ ë‹«íŒ ê²½ìš°)
        if (sessionStorage.getItem('justLoggedIn') !== 'true') {
          sessionStorage.setItem('justLoggedIn', 'true');
          // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ ë¡œë”©ì´ ì™„ì „íˆ ë‹«íŒ í›„ í‘œì‹œ
          setTimeout(() => {
            Swal.fire({
              icon: 'success',
              title: 'ë¡œê·¸ì¸ ì„±ê³µ',
              text: `${user.displayName || user.email}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`,
              timer: 2000,
              showConfirmButton: false
            });
          }, 300);
        }
      } else {
        // ë¡œê·¸ì•„ì›ƒëœ ê²½ìš°
        userInfo.textContent = 'ğŸ” ë¡œê·¸ì¸ í›„ ì´ìš©í•´ ì£¼ì„¸ìš”.';
        loginBtn.style.display = 'flex';
        logoutBtn.style.display = 'none';

        // ë¡œê·¸ì¸ ë©”ì‹œì§€ í‘œì‹œ, ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ ìˆ¨ê¸°ê¸°
        loginMessage.classList.remove('hidden');
        navMenu.classList.add('hidden');

        // ëª¨ë“  ë„¤ë¹„ê²Œì´ì…˜ í•­ëª© ë¹„í™œì„±í™”
        Object.values(navItems).forEach(navItem => {
          if (navItem) {
            navItem.classList.remove('visible');
          }
        });

        // ê´€ë¦¬ì ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        navItems.admin.classList.remove('show');
        
        sessionStorage.removeItem('justLoggedIn');
      }
    });
  </script>
</body>
</html>
